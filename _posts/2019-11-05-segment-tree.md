---
layout: post
title: 线段树
date: 2019-11-05
categories: Programming
tags: C++
status: publish
type: post
published: true
author: Quebradawill
---

### 1. 定义

线段树（segment tree），顾名思义，是用来存放给定区间（segment or interval）内对应信息的一种数据结构。与[树状数组（binary indexed tree）](https://www.jianshu.com/p/5b209c029acd)相似，线段树也用来处理数组相应的区间查询（range query）和元素更新（update）操作。与树状数组不同的是，线段树不但适用于区间求和查询，也可以进行区间最大值、区间最小值（Range Minimum / Maximum Query problem）或区间异或值的查询。

对应于树状数组，线段树进行更新（update）的操作为 $O(\log n)$，进行区间查询（range query）的操作也为 $O(\log n)$。

### 2. 实现原理

从数据结构的角度来说，线段树是用一个**完全二叉树**来存储对应于其每一个区间（segment）的数据。该二叉树的每个结点中保存着相对应于这个区间的信息。同时，线段树所使用的这个二叉树是用一个数组保存的，与堆（Heap）的实现方式相同。

例如，给定一个长度为`N`的数组`arr`，其所对应的线段树`T`各个结点的含义如下：

1.  `T`的根结点代表整个数组所在的区间对应的信息，及`arr[0:N]`（**不含N**)所对应的信息。
2.  `T`的每一个叶结点存储对应于输入数组的每一个单个元素构成的区间`arr[i]`所对应的信息，此处`0≤i。
3.  `T`的每一个中间结点存储对应于输入数组某一区间`arr[i:j]`对应的信息，此处`0≤i。

以根结点为例，根结点代表`arr[0:N]`区间所对应的信息，接着根结点被分为两个子树，分别存储`arr[0:(N-1)/2]`及`arr[(N-1)/2+1:N]`两个子区间对应的信息。也就是说，对于每一个结点，其左右子结点分别存储母结点区间拆分为两半之后各自区间的信息。也就是说对于长度为`N`的输入数组，线段树的高度为`logN`。

对于一个线段树来说，其应该支持的两种操作为：

1. Update：更新输入数组中的某一个元素并对线段树做相应的改变。
2. Query：用来查询某一区间对应的信息（如最大值，最小值，区间和等）。

参考：[线段树（segment tree），看这一篇就够了](https://www.jianshu.com/p/6fd130084a43)

