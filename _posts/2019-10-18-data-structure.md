---
layout: post
title: 数据结构与算法相关问题
date: 2019-10-21
categories: Programming
tags: C++
status: publish
type: post
published: true
author: Quebradawill
---

### 1. 栈的输出序列数

一个栈的输入序列是 $$1,2,3,4,5$$，不可能的输出序列有哪些？算一下 $$1,2,3,4,5$$ 的全排列有多少种，合法的出栈序列的个数是 Catalan 数，两者相减就是不可能的序列的个数。

Catalan 数（卡特兰数）的定义令 $$h(1)=1$$，Catalan 数满足递归式：$$h(n) = h(1) h(n-1) + h(2) h(n-2) + \cdots + h(n-1) h(1), n \geq 2$$，该递推关系的解为：$$h(n) = C(2n-2,n-1)/n，n=1,2,3,...$$（其中 $$C(2n-2,n-1)$$ 表示 $$2n-2$$ 个中取 $$n-1$$ 个的组合数）。

问题描述：12 个高矮不同的人，排成两排，每排必须是从矮到高排列，而且第二排比对应的第一排的人高，问排列方式有多少种？

问题分析：我们先把这 12 个人从矮到高排列，然后，选择 6 个人排在第一排，那么剩下的 6 个肯定是在第二排。用 0 表示对应的人在第一排，用 1 表示对应的人在第二排，那么含有 6 个 0，6 个 1 的序列，就对应一种方案。

比如 $$000000111111$$ 就对应着<br>
第一排：$$ 0 \ 1 \ 2 \ 3\ \ 4\ \ 5$$ <br>
第二排：$$ 6 \ 7 \ 8 \ 9 \ 10 \ 11$$<br>
$$010101010101$$ 就对应着<br>
第一排：$$ 0 \ 2 \ 4 \ 6 \ 8 \ 10$$<br>
第二排：$$1 \ 3 \ 5 \ 7 \ 9 \ 11$$<br>
问题转换为，这样的满足条件的 $$01$$ 序列有多少个。观察 1 的出现，我们考虑这个 1 出现能不能放在第二排，显然，在这个 1 之前出现的那些 $$0,1$$ 对应的人要么是在这个 1 左边，要么是在这个 1 前面。而肯定要有一个 0 的（<font color='blue'>即这个人若是第二排的排头，则他前面有一个人比他矮，也就是第一排的排头，因此，这个人前面至少要有一个 0</font>），在这个 1 前面，统计在这个 1 之前的 0 和 1 的个数。也就是要求，0 的个数大于 1 的个数。

OK，问题已经解决。

如果把 0 看成入栈操作，1 看成出栈操作，就是说给定 6 个元素，合法的入栈出栈序列有多少个（<font color='blue'>此处的 6 个元素应该是任意的，但是入栈序列应该是确定的，合法的出栈序列有多少个</font>）。这就是 Catalan 数，这里只是用于栈，等价地描述还有，<font color='magenta'>二叉树的枚举</font>、<font color='magenta'>多边形分成三角形的个数</font>、<font color='magenta'>圆括弧插入公式中的方法数</font>，其通项是 $$C(2n, n)/(n+1)$$。

在《计算机程序设计艺术》，第三版，Donald E. Knuth著，苏运霖译，第一卷，508页，给出了证明：

问题大意是用 $$S$$ 表示入栈，$$X$$ 表示出栈，那么合法的序列有多少个（$$S$$ 的个数为 $$n$$），显然有 $$C(2n, n)$$ 个含 $$S, X$$ 各 $$n$$ 个的序列，剩下的是计算不允许的序列数（它包含正确个数的 $$S$$ 和 $$X$$，但是违背其它条件）。在任何不允许的序列中，定出使得 $$X$$ 的个数超过 $$S$$ 的个数的第一个 $$X$$ 的位置。然后在导致并包括这个 $$X$$ 的部分序列中，以 $$S$$ 代替所有的 $$X$$ 并以 $$X$$ 代表所有的 $$S$$。结果是一个有 $$(n+1)$$ 个 $$S$$ 和 $$(n-1)$$ 个 $$X$$ 的序列（<font color='blue'>此处的序列是指原序列的前面部分 $S$ 和 $X$ 互换后的完整序列</font>）。反过来，对这种类型的每个序列，我们都能逆转这个过程，而且找出导致它的前一种类型的不允许序列。例如 $$XXSXSSSXXSSS$$ 必然来自 $$SSXSXXXXXSSS$$。这个对应说明，不允许的序列的个数是 $$C(2n, n-1)$$，因此答案为 $$C(2n, n) - C(2n, n-1)$$。

验证：其中 $$F$$ 表示前排，$$B$$ 表示后排，在枚举出前排的人之后，对应的就是后排的人了，然后再验证是不是满足后面的比前面对应的人高的要求。

参考：[Catalan数——卡特兰数](https://blog.csdn.net/hackbuteer1/article/details/7450250)

